<!doctype html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang=""> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8" lang=""> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9" lang=""> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang=""> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Daten eintragen</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

       <!-- Bootstrap -->
<!-- Latest compiled and minified CSS -->
 <link href="/static/css/bootstrap.min.css" rel="stylesheet">
        
        <link href="/static/css/custom.css" rel="stylesheet">

   <link href="/static/css/bootstrap-tagsinput.css" rel="stylesheet">
        
        
        <!-- Leaflet -->
         <link rel="stylesheet" href="https://unpkg.com/leaflet@1.2.0/dist/leaflet.css"
   integrity="sha512-M2wvCLH6DSRazYeZRIm1JnYyh22purTM+FDB5CsyxtQJYeKq83arPe5wgbNmcFXGqiSH2XR8dT/fJISVA1r/zQ=="
   crossorigin=""/>
        <script src="https://unpkg.com/leaflet@1.2.0/dist/leaflet.js"
   integrity="sha512-lInM/apFSqyy1o6s89K4iQUKg6ppXEgsVxT35HbzUupEVRh2Eu9Wdl4tHj7dZO0s1uvplcYGmt3498TtHq+log=="
   crossorigin=""></script>
        
          <!-- Load Esri Leaflet from CDN -->
    <script src="https://unpkg.com/esri-leaflet@2.1.1/dist/esri-leaflet.js"
    integrity="sha512-ECQqaYZke9cSdqlFG08zSkudgrdF6I1d8ViSa7I3VIszJyVqw4ng1G8sehEXlumdMnFYfzY0tMgdQa4WCs9IUw=="
    crossorigin=""></script>


  <!-- Load Esri Leaflet Geocoder from CDN -->
  <link rel="stylesheet" href="https://unpkg.com/esri-leaflet-geocoder@2.2.6/dist/esri-leaflet-geocoder.css"
    integrity="sha512-v5YmWLm8KqAAmg5808pETiccEohtt8rPVMGQ1jA6jqkWVydV5Cuz3nJ9fQ7ittSxvuqsvI9RSGfVoKPaAJZ/AQ=="
    crossorigin="">
  <script src="https://unpkg.com/esri-leaflet-geocoder@2.2.6/dist/esri-leaflet-geocoder-debug.js"
    integrity="sha512-NE6FicJEhXDHZNxWrGwC4gdaxb7iOMsp7+bQSintY+stx4GpoUpNAH+yuiE1uduT5inQCPPmH0lf0cdjJFfwcA=="
    crossorigin=""></script>
        

 <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
 <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
 <!--[if lt IE 9]>
 <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
 <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
 <![endif]-->

        <nav class="navbar navbar-default">
 <div class="container-fluid">
 <!-- Brand and toggle get grouped for better mobile display -->
 <div class="navbar-header">
 <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
 <span class="sr-only">Toggle navigation</span>
 <span class="icon-bar"></span>
 <span class="icon-bar"></span>
 <span class="icon-bar"></span>
 </button>
 <a class="navbar-brand" href="/">Open Data Demo</a>
 </div>

 <!-- Collect the nav links, forms, and other content for toggling -->
 <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
 <ul class="nav navbar-nav">
 <li class="active"><a href="/add">Daten eintragen <span class="sr-only">(current)</span></a></li>
 <li><a href="/rounds">Spielrunden</a></li>
 </ul>
      <ul class="nav navbar-nav navbar-right">
        <% if (typeof sessionID != 'undefined'){ %>
           <li><a href="/user/profile">Mein Profil</a></li>
           <li><a href="/user/logout">Logout</a></li>
          <% } else { %>
           <li><a href="/user/register">Registrieren</a></li>
        <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Login <span class="caret"></span></a>
                        <ul class="dropdown-menu dropdown-lr animated slideInRight" role="menu">
                            <div class="col-lg-12">
                                <div class="text-center"><h3><b>Login</b></h3></div>
                                <div class="row"> 
                                <div class="col-xs-12">
                                    <div class="text-center"> Noch nicht registriert? <a href="/user/register">Jetzt hier anmelden</a>
                                    </div></div>
                                </div><br />
                                <form id="ajax-login-form" action="/user/login" method="post" role="form" autocomplete="off">
                                    <div class="form-group">
                                        <label for="username">Username</label>
                                        <input type="text" name="logusername" id="username" tabindex="1" class="form-control" placeholder="Username" value="" autocomplete="off">
                                    </div>

                                    <div class="form-group">
                                        <label for="password">Passwort</label>
                                        <input type="password" name="logpassword" id="password" tabindex="2" class="form-control" placeholder="Passwort" autocomplete="off">
                                    </div>

                                    <div class="form-group">
                                        <div class="row">
                                          
                                            <div class="col-xs-12 pull-right">
                                                <input type="submit" name="login-submit" id="login-submit" tabindex="4" class="form-control btn btn-success" value="Einloggen">
                                            </div>
                                        </div>
                                    </div>  
                                </form>
                            </div>
                        </ul>
          </li>
          <% } %>
      </ul>
 </div><!-- /.navbar-collapse -->
 </div><!-- /.container-fluid -->
 </nav>
        
    </head>
    <body>
     

  
<div id="wrapper">
     <div id="mymap"></div>
     
 <div id="over_map">
<button type="button" id="plusbutton" class="btn btn-default">+</button>
   </div>
        
    <div id="over_map_points">
<button type="button" id="pointsbutton" class="btn btn-default">0</button>
   </div>
        
    
       <div class="modal fade">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
           <button type="button" class="close" data-dismiss="modal" aria-label="Close">
               <span aria-hidden="true">&times;</span>   </button>
        <h4 class="modal-title">Neuen Beitrag anlegen</h4>
       
     
      </div>
      <div class="modal-body">
       <form>
    <div class="form-group">
         <label for="currentposition">Deine aktuelle Position: </label>
        <div id="myposition"></div>
    </div>
 <div class="form-group">
 <label for="fileuploadlabel">Lade ein Bild von dem hoch, was du siehst:</label>
  <input type="file" class="form-control-file" id="fileupload">
 </div>
 <div class="form-group">
      <label for="categorylabel">Kategorisiere deinen Fund:</label>
     <br />
     <input type="text" id="tagsinput" value="" data-role="tagsinput"/>    
 
 </div>
     <div class="form-group">
    <label for="textarealabel">Hast du weitere Informationen?</label>
    <textarea class="form-control" id="textarea" rows="3"></textarea>
  </div>
</form>
      </div>
      <div class="modal-footer">
         <button type="submit" class="btn btn-primary">Absenden</button>
      </div>
    </div>
  </div>
</div>
        </div>
        
<hr>
       
       <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
 <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
        <script>
           $( document ).ready(function() {

               var mymap = L.map('mymap');

	L.tileLayer( 'https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png', {
        maxZoom: 18, attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors' }).addTo( mymap );



	function onLocationError(e) {
		alert(e.message);
	}


	mymap.on('locationerror', onLocationError);

	mymap.locate({setView: true, maxZoom: 16});

       
        var geocodeService = L.esri.Geocoding.geocodeService();

       var marker = null;
       
 	function onLocationFound(e) {
		
        marker = L.marker(e.latlng, {
draggable: true
}).addTo(mymap);
        
        var radius = e.accuracy / 2;
        
 geocodeService.reverse().latlng(e.latlng).run(function(error, result) {
      marker.bindPopup(result.address.Match_addr).openPopup();      

		L.circle(e.latlng, radius).addTo(mymap);
     
       $('#myposition').html(result.address.Match_addr);
     
          });
        
      
        
    }
       
	mymap.on('locationfound', onLocationFound);
       
       
              function onMapClick(e) {
  marker.on('dragend', function(event){
    var marker = event.target;
    var position = marker.getLatLng();
    marker.setLatLng(new L.LatLng(position.lat, position.lng),{draggable:'true'});
    mymap.panTo(new L.LatLng(position.lat, position.lng))
  });
  mymap.addLayer(marker);
};

mymap.on('click', onMapClick);
               
                //getting click event to show modal
    $('#plusbutton').click(function () {
        $('.modal').modal();
      
      //appending modal background inside the bigform-content
        $('.modal-backdrop').appendTo('#wrapper');
      //removing body classes to able click events
        $('body').removeClass();
    });
               
               
               var citynames = new Bloodhound({
  datumTokenizer: Bloodhound.tokenizers.obj.whitespace('name'),
  queryTokenizer: Bloodhound.tokenizers.whitespace,
  prefetch: {
    url: '/static/citynames.json',
    filter: function(list) {
      return $.map(list, function(cityname) {
        return { name: cityname }; });
    }
  }
});
citynames.initialize();

$('#tagsinput').tagsinput({
  typeaheadjs: {
    name: 'citynames',
    displayKey: 'name',
    valueKey: 'name',
    source: citynames.ttAdapter()
  },   confirmKeys: [44,188,32]
});
               
       });</script>
        
        
        
 <!-- Include all compiled plugins (below), or include individual files as needed -->
<!-- Latest compiled and minified JavaScript -->
   <script src="/static/js/bootstrap.min.js"></script>
      
         <script src="/static/js/bootstrap-tagsinput.js"></script>
        
         <script src="/static/js/typeahead.js"></script>
    </body>
</html>
